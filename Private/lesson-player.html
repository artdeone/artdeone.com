<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson Player - ART de ONE</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Poppins', sans-serif; background-color: #000; color: #fff; overflow-x: hidden; }
        
        /* Navbar */
        nav { background-color: rgba(17,17,17,0.9); border-bottom: 1px solid #333; backdrop-filter: blur(10px); }
        
        /* Player Area */
        .video-wrapper {
            background-color: #000;
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            border-bottom: 1px solid #333;
        }
        .video-wrapper video {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            outline: none;
        }
        
        /* Sidebar Playlist */
        .playlist-container {
            background-color: #111;
            border-left: 1px solid #333;
            height: calc(100vh - 64px); /* Full height minus navbar */
            overflow-y: auto;
        }
        
        .lesson-item {
            padding: 1rem;
            border-bottom: 1px solid #222;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }
        .lesson-item:hover { background-color: #1a1a1a; }
        .lesson-item.active { background-color: #1a1a1a; border-left: 3px solid #9dae11; }
        .lesson-item i { color: #9dae11; margin-right: 10px; font-size: 0.8rem; }
        .lesson-title { font-size: 0.9rem; font-weight: 500; }
        .lesson-duration { font-size: 0.75rem; color: #666; margin-left: auto; }

        /* Scrollbar */
        .playlist-container::-webkit-scrollbar { width: 6px; }
        .playlist-container::-webkit-scrollbar-track { background: #111; }
        .playlist-container::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        
        @media (max-width: 768px) {
            .playlist-container { height: auto; border-left: none; border-top: 1px solid #333; }
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="h-16 flex items-center justify-between px-6 z-50">
        <div class="flex items-center">
            <a href="student-dashboard.html" class="text-gray-400 hover:text-white mr-4">
                <i class="fas fa-arrow-left"></i> Back
            </a>
            <span class="font-bold text-lg tracking-wide">Course Content</span>
        </div>
        <div class="text-sm text-gray-400">
            Logged in as <span id="user-email" class="text-white font-medium">...</span>
        </div>
    </nav>

    <!-- Main Layout -->
    <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
        
        <!-- Left: Video Player -->
        <div class="flex-1 flex flex-col bg-black overflow-y-auto">
            <div class="video-wrapper">
                <video id="main-player" controls>
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            
            <div class="p-8 max-w-4xl">
                <h1 id="video-title" class="text-2xl font-bold mb-2">Select a lesson to start</h1>
                <p id="video-desc" class="text-gray-500 leading-relaxed">
                    Click on a lesson from the playlist on the right to begin watching.
                </p>
                
                <div class="mt-8 pt-8 border-t border-[#222] flex space-x-4">
                    <button class="bg-[#222] hover:bg-[#333] text-white px-4 py-2 rounded text-sm">
                        <i class="fas fa-download mr-2"></i> Download Files
                    </button>
                    <button class="bg-[#222] hover:bg-[#333] text-white px-4 py-2 rounded text-sm">
                        <i class="fas fa-comment mr-2"></i> Discussion
                    </button>
                </div>
            </div>
        </div>

        <!-- Right: Playlist -->
        <div class="w-full md:w-80 playlist-container flex-shrink-0">
            <div class="p-4 bg-[#1a1a1a] border-bottom border-[#333]">
                <h3 class="font-bold text-sm uppercase tracking-wider text-gray-400">Course Modules</h3>
            </div>
            <div id="playlist-items">
                <!-- Items will be injected here by JS -->
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDxGe8syla67VxbV7DlnbPtIbMmIewZurY",
            authDomain: "art-de-one.firebaseapp.com",
            projectId: "art-de-one",
            storageBucket: "art-de-one.firebasestorage.app",
            messagingSenderId: "843424361824",
            appId: "1:843424361824:web:d8e645ad12fe5f50be8205",
            measurementId: "G-1W0PCMKRW7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // 1. Dummy Data for Lessons (In real life, this comes from Database)
        const lessons = [
            { id: 1, title: "1. Introduction to Interface", duration: "10:24", url: "https://www.w3schools.com/html/mov_bbb.mp4", desc: "Learning the basics of the workspace." },
            { id: 2, title: "2. Working with Layers", duration: "15:30", url: "https://www.w3schools.com/html/movie.mp4", desc: "Understanding layer hierarchy and management." },
            { id: 3, title: "3. Pen Tool Mastery", duration: "22:10", url: "https://www.w3schools.com/html/mov_bbb.mp4", desc: "The most important tool for any vector artist." },
            { id: 4, title: "4. Shape Builder & Pathfinder", duration: "18:45", url: "https://www.w3schools.com/html/movie.mp4", desc: "Creating complex shapes from simple ones." }
        ];

        // 2. Auth Check
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('user-email').innerText = user.email;
                renderPlaylist();
                // Auto play first lesson
                loadLesson(0);
            } else {
                window.location.href = "student-login.html";
            }
        });

        // 3. Render Playlist
        function renderPlaylist() {
            const container = document.getElementById('playlist-items');
            let html = '';
            lessons.forEach((lesson, index) => {
                html += `
                <div class="lesson-item" onclick="playLesson(${index})" id="lesson-${index}">
                    <i class="fas fa-play-circle"></i>
                    <div class="lesson-title">${lesson.title}</div>
                    <div class="lesson-duration">${lesson.duration}</div>
                </div>
                `;
            });
            container.innerHTML = html;
        }

        // 4. Play Lesson Function (Global Scope for HTML onclick)
        window.playLesson = (index) => {
            loadLesson(index);
        };

        function loadLesson(index) {
            const lesson = lessons[index];
            const player = document.getElementById('main-player');
            
            // Update Video Source
            player.src = lesson.url;
            player.play();
            
            // Update Text
            document.getElementById('video-title').innerText = lesson.title;
            document.getElementById('video-desc').innerText = lesson.desc;

            // Highlight Active Item
            document.querySelectorAll('.lesson-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`lesson-${index}`).classList.add('active');
        }
    </script>
</body>
</html>
